cmake_minimum_required(VERSION 2.6)
project(HV-adjust)
set(CMAKE_CXX_FLAGS "-pthread -std=gnu++11")

list(APPEND CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake)
find_package(PQXX REQUIRED)
include_directories(${PQXX_INCLUDE_DIRS})
add_definitions(${PQXX_DEFINITIONS})

add_subdirectory(math_h)
include_directories(math_h/include)
include_directories(include)
file(GLOB HEADERS include/*.h)
file(GLOB SOURCES src/*.cpp)
file(GLOB TESTS tests/*.cpp)
file(GLOB EXAMPLES example/*.cpp)
add_library(hvadjust SHARED ${SOURCES})
target_link_libraries(hvadjust ${PQXX_LIBRARIES})

foreach(example ${EXAMPLES})
	get_filename_component(ex_app ${example} NAME_WE)
	add_executable(${ex_app} ${example})
	target_link_libraries(${ex_app} hvadjust ${PQXX_LIBRARIES})
endforeach()

option(tests "Compile tests." OFF) 
if(tests)
	find_package(GTest REQUIRED)
	include_directories(${GTEST_INCLUDE_DIRS})
	add_executable(hvadjust-test.exe ${TESTS})
	target_link_libraries(hvadjust-test.exe hvadjust ${PQXX_LIBRARIES})
endif()
